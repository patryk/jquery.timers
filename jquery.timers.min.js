jQuery(function(e){e.fn.extend({everyTime:function(t,n,r,i){return this.each(function(){e.timer.add(this,t,n,r,i)})},oneTime:function(t,n,r){return this.each(function(){e.timer.add(this,t,n,r,1)})},stopTime:function(t,n){return this.each(function(){e.timer.remove(this,t,n)})}});e.extend({timer:{global:[],guid:1,dataKey:"$.timer",regex:/^([0-9]+(?:\.[0-9]*)?)\s*(.*s)?$/,powers:{ms:1,cs:10,ds:100,s:1e3,das:1e4,hs:1e5,ks:1e6},timeParse:function(t){if(t==undefined||t==null)return null;var n=this.regex.exec(e.trim(t.toString()));if(n[2]){var r=parseFloat(n[1]);var i=this.powers[n[2]]||1;return r*i}else{return t}},add:function(t,n,r,i,s){var o=0;if(e.isFunction(r)){if(!s)s=i;i=r;r=n}n=e.timer.timeParse(n);if(typeof n!="number"||isNaN(n)||n<0)return;if(typeof s!="number"||isNaN(s)||s<0)s=0;s=s||0;var u=e.data(t,this.dataKey)||e.data(t,this.dataKey,{});if(!u[r])u[r]={};i.timerID=i.timerID||this.guid++;var a=function(){if(++o>s&&s!==0||i.call(t,o)===false)e.timer.remove(t,r,i)};a.timerID=i.timerID;if(!u[r][i.timerID])u[r][i.timerID]=window.setInterval(a,n);this.global.push(t)},remove:function(t,n,r){var i=e.data(t,this.dataKey),s;if(i){if(!n){for(n in i)this.remove(t,n,r)}else if(i[n]){if(r){if(r.timerID){window.clearInterval(i[n][r.timerID]);delete i[n][r.timerID]}}else{for(var r in i[n]){window.clearInterval(i[n][r]);delete i[n][r]}}for(s in i[n])break;if(!s){s=null;delete i[n]}}for(s in i)break;if(!s)e.removeData(t,this.dataKey)}}}});e(window).bind("unload",function(){e.each(e.timer.global,function(t,n){e.timer.remove(n)})})})
